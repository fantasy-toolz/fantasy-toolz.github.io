<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title>Target Field, 2019</title>
<script src="https://d3js.org/d3.v5.min.js"></script>

</head>

<body>
<style>

.svg-container {
    display: inline-block;
    position: relative;
    width: 100%;
    padding-bottom: 10%;
    vertical-align: top;
    overflow: hidden;
}
.svg-content {
    display: inline-block;
    position: absolute;
    top: 0;
    left: 0;
}

div.tooltip {
  color: white;
  position: absolute;
  text-align: center;
  width: 300px;
  height: 28px;
  padding: 2px;
  font: 12px sans-serif;
  background: rgba(0,0,0,.8);
  border: 2px solid black;
  pointer-events: none;
}</style>

<h1>Target Field 2019 Hits</h1>
<p>Every time a ball was hit in Target Field in 2019, with
Batter+Pitcher data and outcome. Colors correspond to exit velocity:
light blue is softly hit, dark blue is hard hit.</p>
<p>Note: some Pitchers may not be recorded currently. Updates to follow...
</p>
<div class="chart"></div>

<script>

// resizing: https://chartio.com/resources/tutorials/how-to-resize-an-svg-when-the-window-is-resized-in-d3-js/

//'xpos','ypos','date','batter','pitcher','exitvel','exitangle','event'
d3.csv("targetfield.csv").then( function(data){
console.log(data[0]);
//data.forEach( function(d) {
  //      d['xpos'] = +d['xpos'];
//d.ypos = +d.ypos;
//d.date = +d.date;
        //d.g = +d.g;
       // //We also want to calculate the strikeouts per game and store it as a new column
//  d.kpg = d.so / d.g;
//console.log(d.date);
  //  });
// console.log(data.xpos);

var newData = data.filter(filterCriteria);

function filterCriteria(d) { return d.exitvel >= 45 }


var svg = d3.select(".chart")
.append("svg")
.attr("viewBox", "0 0 1000 600")
.attr("preserveAspectRatio", "xMinYMin meet")
       // .attr("width", 700)
//.attr("height", 300);

var margin = {top: 50, right: 50, bottom: 50, left: 50}
  , width = window.innerWidth - margin.left - margin.right // Use the window's width 
  , height = window.innerHeight - margin.top - margin.bottom; // Use the window's height


var xScale = d3.scaleLinear()
      .domain([0,250])
      .range([0, width]);

var yScale = d3.scaleLinear()
      .domain([-220, 0])
.range([height,0]);

// 3. Call the x axis in a group tag
svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(xScale)); // Create an axis component with d3.axisBottom

// 4. Call the y axis in a group tag
svg.append("g")
    .attr("class", "y axis")
    .call(d3.axisLeft(yScale)); // Create an axis component with d3.axisLeft


const tooltip = d3.select("body").append("div")
    .attr("class", "tooltip")
.style("opacity", 0);

// setup x 
var xValue = function(d) { return d.xpos;}, // data -> value
    xScale = d3.scaleLinear().domain([0,250]).range([0, width]), // value -> display
    xMap = function(d) { return xScale(xValue(d));}, // data -> display
    xAxis = d3.axisBottom(xScale);

// setup y
var yValue = function(d) { return d.ypos;}, // data -> value
    yScale = d3.scaleLinear().domain([-220,0]).range([height, 0]), // value -> display
    yMap = function(d) { return yScale(yValue(d));}, // data -> display
yAxis = d3.axisLeft(yScale);

var colorScale = d3.scaleSequential(d3.interpolateBlues).domain([40,120]);



  // draw dots
  svg.selectAll(".dot")
//.data(data)
.data(newData)
    .enter().append("circle")
      .attr("class", "dot")
      .attr("r", 3.5)
      .attr("cx", xMap)
      .attr("cy", yMap)
.style("fill", function(d) { return colorScale(d['exitvel']); })

.on("mouseover", function(d) {
tooltip.transition()
               .duration(200)
               .style("opacity", .9);
tooltip
.html(d['batter'] +"vs"+d['pitcher'] + "<br/>" +d['date']+", "+d['exitangle'] +"deg, "+d['event'])
               .style("left", (d3.event.pageX + 5) + "px")
               .style("top", (d3.event.pageY - 28) + "px");
      })
      .on("mouseout", function(d) {
          tooltip.transition()
               .duration(500)
               .style("opacity", 0);
      });
});
</script>

<hr>
<address></address>
<!-- hhmts start -->Last modified: Tue Aug 27 14:38:03 BST 2019 <!-- hhmts end -->
</body> </html>
